rule  Dev_sigma_antivirus_web_shell_detection {
 meta:
    author = "Florian Roth, Arnim Rupp"
    description = "Detects a highly relevant Antivirus alert that reports a web shell. It's highly recommended to tune this rule  Dev_sigma_to the specific strings used by your anti virus solution by downloading a big webshell repo from e.g. github and checking the matches. Author: Florian Roth, Arnim Rupp."
    reference = ""
    version = "0.01"
    created = "2018/09/09"
    product = "antivirus"
    mitre = "persistence, t1100, t1505.003"

  events:
((re.regex($selection.target.registry.registry_value_data, `PHP/.*`) or re.regex($selection.target.registry.registry_value_data, `JSP/.*`) or re.regex($selection.target.registry.registry_value_data, `ASP/.*`) or re.regex($selection.target.registry.registry_value_data, `Perl/.*`) or re.regex($selection.target.registry.registry_value_data, `PHP\..*`) or re.regex($selection.target.registry.registry_value_data, `JSP\..*`) or re.regex($selection.target.registry.registry_value_data, `ASP\..*`) or re.regex($selection.target.registry.registry_value_data, `Perl\..*`) or re.regex($selection.target.registry.registry_value_data, `VBS/Uxor.*`) or re.regex($selection.target.registry.registry_value_data, `IIS/BackDoor.*`) or re.regex($selection.target.registry.registry_value_data, `JAVA/Backdoor.*`) or re.regex($selection.target.registry.registry_value_data, `Troj/ASP.*`) or re.regex($selection.target.registry.registry_value_data, `Troj/PHP.*`) or re.regex($selection.target.registry.registry_value_data, `Troj/JSP.*`)) or (re.regex($selection.target.registry.registry_value_data, `.*Webshell.*`) or re.regex($selection.target.registry.registry_value_data, `.*Chopper.*`) or re.regex($selection.target.registry.registry_value_data, `.*SinoChoper.*`) or re.regex($selection.target.registry.registry_value_data, `.*ASPXSpy.*`) or re.regex($selection.target.registry.registry_value_data, `.*Aspdoor.*`) or re.regex($selection.target.registry.registry_value_data, `.*filebrowser.*`) or re.regex($selection.target.registry.registry_value_data, `.*PHP_.*`) or re.regex($selection.target.registry.registry_value_data, `.*JSP_.*`) or re.regex($selection.target.registry.registry_value_data, `.*ASP_.*`) or re.regex($selection.target.registry.registry_value_data, `.*PHP:.*`) or re.regex($selection.target.registry.registry_value_data, `.*JSP:.*`) or re.regex($selection.target.registry.registry_value_data, `.*ASP:.*`) or re.regex($selection.target.registry.registry_value_data, `.*Perl:.*`) or re.regex($selection.target.registry.registry_value_data, `.*PHPShell.*`) or re.regex($selection.target.registry.registry_value_data, `.*Trojan\.PHP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Trojan\.ASP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Trojan\.JSP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Trojan\.VBS.*`) or re.regex($selection.target.registry.registry_value_data, `.*PHP\?Agent.*`) or re.regex($selection.target.registry.registry_value_data, `.*ASP\?Agent.*`) or re.regex($selection.target.registry.registry_value_data, `.*JSP\?Agent.*`) or re.regex($selection.target.registry.registry_value_data, `.*VBS\?Agent.*`) or re.regex($selection.target.registry.registry_value_data, `.*Backdoor\?PHP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Backdoor\?JSP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Backdoor\?ASP.*`) or re.regex($selection.target.registry.registry_value_data, `.*Backdoor\?VBS.*`) or re.regex($selection.target.registry.registry_value_data, `.*Backdoor\?Java.*`)))

  condition:
    $selection
}
